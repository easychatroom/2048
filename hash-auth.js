async function authenticateFromURL(){const e=new URLSearchParams(window.location.search).get("token");if(!e){const e=sessionStorage.getItem("2048_user"),t=sessionStorage.getItem("2048_avatar");return e&&t?{username:e,avatarBase64:t}:(alert("Access denied. Please log in at the main page."),window.location.href="https://webuserent.org",null)}const t=await db.ref("auth").get();let a=null;return t.forEach((t=>{const s=t.val();s&&s.passwordHash===e&&(a=s)})),a?(sessionStorage.setItem("2048_user",a.username),sessionStorage.setItem("2048_avatar",a.avatarBase64||""),history.replaceState({},document.title,window.location.pathname),a):(alert("Invalid or expired session. Please log in again."),window.location.href="https://webuserent.org",null)}